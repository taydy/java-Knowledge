## CPU 构成

逻辑上，我们可以认为，CPU 其实就是由一堆寄存器组成的。而寄存器就是 CPU 内部，由多个触发器(Flip Flop)或者锁存器(Latches)组成的简单电路。

触发器和锁存器，其实就是两种不同原理的数字电路组成的逻辑门。

N 个触发器或者锁存器，就可以组成一个 N 位(Bit)的寄存器，能够保存 N 位的数据。比方说，我们用的 64 位 Intel 服务器，寄存器就是 64 位的。

![](https://tva1.sinaimg.cn/large/006tNbRwgy1gax20zihnfj31gg0u0qc4.jpg)

一个 CPU 里面会有很多种不同功能的寄存器。这里给你介绍三种比较特殊的。

- **PC 寄存器(Program Counter Register), 也叫 指令地址寄存器(Instruction Address Register)** 用来存放下一条需要执行的计算机指令的内存地址；
- **指令寄存器(Instruction Register)** 用来存放当前正在执行的指令；
- **条件码寄存器(Status Register)** 用里面的一个个标记位(Flag)，存放 CPU 进行算术或者逻辑计算的结果。

除了这些特殊的寄存器，CPU 里面还有更多用来存储数据和内存地址的寄存器。这样的寄存器通常一类里面不止一个。我们通常根据存放的数据内容来给它们取名字，比如整数寄存器、浮点数寄存器、向量寄存器和地址寄存器等等。有些寄存器既可以存放数据，又能存放地址，我们就叫它通用寄存器。

实际上，一个程序执行的时候，CPU 会根据 PC 寄存器里的地址，从内存里面把需要执行的指令读取到指令寄存器里面执行，然后根据指令长度自增，开始顺序读取下一条指令。可以看到，一个程序的一条条指令，在内存里面是连续保存的，也会一条条顺序加载。

而有些特殊指令，比如 J 类指令，也就是跳转指令，会修改 PC 寄存器里面的地址值。这样，下一条要执行的指令就不是从内存里面顺序加载的了。

事实上，这些跳转指令的存在，也是我们可以在写程序的时候，使用 if…else 条件语句和 while/for 循环语句的原因。

## CPU 缓存

### SRAM

SRAM 被称为静态存储器，只有在通电状态，里面的数据才能保持存在。而一旦断电，里面的数据就会丢失。

在 SRAM 里，一个比特的数据，需要 6~8 个晶体管，所以 SRAM 的存储密度不高，同样的物理空间下，能够存储的数据有限。

正因为 SRAM 电路简单，所以访问速度非常快，CPU Cacge(CPU 高速缓存) 便是用的 SRAM。

![](https://tva1.sinaimg.cn/large/006tNbRwgy1gb24p1l1zwj30zk0qogmq.jpg)

在 CPU 里，通常会有 L1、L2、L3 这样三层高速缓存。

每个 CPU 核心都有一块属于自己的 L1 高速缓存，通常分成**指令缓存**和**数据缓存**，分开存放 CPU 使用的指令和数据。L1 Cache 往往嵌在 CPU 核心的内部，因此访问速度极快。

L2 Cache 同样是每个 CPU 核心都有的，不过它往往不在 CPU 核心的内部。所以 L2 Cache 的访问速度比 L1 稍微慢一些。

L3 Cache 通常由多个 CPU 核心共用，尺寸会更大一下，访问速度也更慢一些。

### DRAM

DRAM(Dynamic Random Access Memory, 动态随机存取存储器)被称为动态存储器，它需要靠不断的“刷新”，才能保持数据被存储起来。

DRAM 的一个比特，只需要一个晶体管和一个电容就能存储。所以，DRAM 在同样的物理空间下，能够存储的数据也就更多。

因为数据时存储在电容里的，电容会不断漏电，多以需要定时刷新充电，才能保持数据不丢失。

DRAM 的数据访问电路和刷新电路都比 SRAM 更复杂，所以访问延时也就更长。

