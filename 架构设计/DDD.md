# DDD 领域驱动设计

## 理念与名词

一个领域模型会包含多个聚合，一个聚合包含多个领域对象，每个领域对象都有自己的领域类型。领域类型主要标识领域对象的属性，比如：聚合根、实体、命令和领域事件等类型。

![](https://tva1.sinaimg.cn/large/00831rSTgy1gcmlp12udxj30zo0rm0vs.jpg)

## DDD 分层架构模型

它包括用户接口层、应用层、领域层和基础层，分层架构各层的职责边界非常清晰，又能有条不紊地分层协作。

![](https://tva1.sinaimg.cn/large/00831rSTgy1gcmlbp4f1sj30uq0rotbo.jpg)

- **用户接口层** 面向前端提供服务适配，面向资源层提供资源适配。这一层聚集了接口适配相关的功能；
- **应用层** 实现服务组合和编排，适应业务流程快速变化的需求。这一层聚集了应用服务和事件相关的功能；
- **领域层** 实现领域的核心业务逻辑。这一层聚集了领域模型的聚合、聚合根、实体、值对象、领域服务和事件等领域对象，以及它们组合所形成的业务能力；
- **基础层** 贯穿所有层，为各层提供基础资源服务。这一层聚集了各种底层资源相关的服务和能力。



## 数据对象视图

- **数据持久化对象 PO(Persistent Object)** 与数据库结构一一映射，是数据持久化过程中的数据载体；
- **领域对象 DO（Domain Object）** 微服务运行时的实体，是核心业务的载体；
- **数据传输对象 DTO（Data Transfer Object）** 用于前端与应用层或者微服务之间的数据组装和传输，是应用之间数据传输的载体；
- **视图对象 VO（View Object）** 用于封装展示层指定页面或组件的数据。

![](https://tva1.sinaimg.cn/large/00831rSTgy1gcmlwdk7zhj31km0qqqal.jpg)



## 保护领域



![保护领域](https://tva1.sinaimg.cn/large/00831rSTgy1gcmfy5oyymj319x0ddq50.jpg)



- 消除上下文间的隐士数据依赖
- 明确定义依赖方向



## 聚合根

- 聚合根封装其内部实体和值对象，并保证数据的最终一致性；
- 一个聚合根对应一个 repository，而不是一个实体对应一个；
- 聚合根之间不能建立关系，只能通过 ID 引用。



